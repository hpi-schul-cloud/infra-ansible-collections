# Last Modified: Mon May 26 08:42:
# 15 2025
#include <tunables/global>

#/var/ossec/bin/wazuh-agentd flags=(audit){
#/var/ossec/bin/wazuh-agentd flags=(complain){
/var/ossec/bin/wazuh-agentd {
  #include <abstractions/base>

  /var/ossec/bin/wazuh-agentd mr,
  /var/ossec/queue/sockets/queue wr,
  /var/ossec/queue/sockets/modules r,
  /var/ossec/queue/sockets/wmodules wr,
  /var/ossec/queue/sockets/.agent_info wr,
  /var/ossec/queue/sockets/.wait wr,
  /var/ossec/queue/sockets/syscheck wr,

  /etc/host.conf r,
  /etc/nsswitch.conf r,
  /etc/passwd r,
  /etc/group r,
  /run/systemd/resolve/stub-resolv.conf r,
  /etc/hosts r,

  /var/ossec/etc/** r,

  /var/ossec/logs/ossec.log wr,
  /var/ossec/var/run/wazuh-agentd.state.temp wr,
  /var/ossec/var/run/wazuh-agentd.state wr,
  /var/ossec/queue/alerts/execq wr,

  /var/ossec/queue/rids/* wr,
  /var/ossec/queue/rids/sender_counter wr,

  /var/ossec/var/run/wazuh-agentd-@{pid}.pid wr,

  /var/ossec/lib/lib*so* mr,

  network,

  capability dac_read_search,
  capability setgid,
  capability setuid,

}
